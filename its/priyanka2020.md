The Amalgamation of Blockchain with Smart and Connected Vehicles: Requirements, Attacks, and Possible Solution

VANET是MANET的一個特例，特別是應用在高速的智慧及聯網車載網路。智慧型車載裝置包括車載單元、感測器、GPS、攝影機等。藉由VANET，車輛、路邊單元、交通號誌、行人、建築都可進行連線，建立成一個隨意網絡，以提供駕駛或乘客安全、舒適、有娛樂性的旅程。VANET可以提供駕駛即時的路況，藉以使駕駛做出正確的決定。由於車輛的高速移動性、駕駛個人的掌控車輛能力、每日路況的千變萬化、及交通意外造成人員傷亡與財物損失，使得VANET變為一個相當複雜的網路。安全性的考量及資通攻擊對網路帶來的損壞衝擊都是VANET研究領域的重點。

現代化先進技術，如雲端計算、迷霧計算(fog computing)、邊緣計算、機器學習、及區塊鏈技術，影響每一個應用研究領域，VANET也不例外，如何應用區塊鏈技術於智慧與聯網車輛的安全是本篇的重點。

區塊鏈(Blockchain)是一種分散式、去中心化、不可更改(immutable)、及分散式賬本技術 [^1]（Distributed ledger Technology，DLT），資料儲存於區塊]，區塊使用雜湊技術連結。區塊鏈於2008年由Satoshi Nakamoto所開發，原用於加密貨幣(Cryptocurrency)。區塊鏈以共識技術(consensus-based technique)為基礎，利用區塊驗證新資料，共識機制包括PoW、PoS、PBFT等。

VANET 是一個完全即時和動態的系統，需要滿足很多安全和隱私要求。安全要求越多，系統就越強大，因此這些要求是判斷系統效率的關鍵因素。
* 身份認證：確保了相互通訊的節點是合法的，意味網路的真正節點具有明確定義的身份。
* 可用性：確保通訊期間的數據對兩個節點都是可用的。如果通訊通道中斷，可能是由於流量擁塞，網路應提供替代通道進行通訊。
* 不可否認性：在通訊過程中發送者的身份被記錄，因此發送者不能拒絕承認訊息的傳輸。
* 機密性：保證數據只會被身份驗證的節點讀取。
* 完整性：傳輸數據的可接受性還包括完整的準確性、全面性和一致性，除了僅驗證發送者之外，因為從身份驗證的發送者收到的消息可能是錯誤的。
* 存取控制：訪問控制要求僅對網路的授權節點進行訪問。
* 隱私：防止駕駛的資訊和身份細節被未經授權的實體獲得。
* 資料驗證：網路傳遞的資料必須確保正確。
* 可靠性：有關網路節點間進行成功通訊。
* 即時限制：VANET 中的車輛以非常高的速度行駛，尤其是在高速公路上，因此必須遵守嚴格的時間限制。

### VANET的安全需求與區塊鏈的關聯性

身份認證 (Authentication)

* 路邊單元運用車輛公鑰系統確認電子簽章的身份
* 車載單元經由服務經理(Service Manager)確認身分，服務經理將身份認證結果廣播傳送給無線網路中的節點(wireless peers)，並將結果寫入公共帳本中
* 由惡意節點產生的假訊息很高機會可以藉由共識演算法拒絕，即便偶然假訊息被接受，追蹤機制(tracer)能夠辨識發現訊息傳送者，並對假訊息懲治處理
* 利用橢圓圖形雙線配對理論的數位簽章演算法檢查車輛的合法識別
* 為了授權和驗證資料交換，認證機構為所有節點生成專有數位身份

即時限制
* 與其他基於區塊鏈的方案不同，VANET 訊息不需要超出國家邊界
* 使通信和計算耗費非常低，因此使系統輕量級成為實時系統的需要
* 為了使訊息簡短而非 n 個單獨的簽名，使用單個多重簽名方案。在這種情況下，如果公告訊息由 t(threshold) 數量的用戶簽名，則認為是可信的。

驗證
	* 其他車輛接收事件訊息，根據車輛的信任級別、事件位置、位置證明、速度、行駛方向等證據進行驗證。
	* 使用 PBFT 共識演算法避免網路出現數據毀損的問題。

機密性
* 稽核部門利用公共金鑰對服務管理器(SM)和車載單元(OBU)的真實身份進行加密，攻擊者沒有對應的私鑰，無法篡改訊息。任何惡意節點如果以任何方式截獲訊息，除了化名(pseudonym)和時間戳外，都無法獲得更多詳細資訊。

完整性
* 如果惡意節點以任何方式竄改消息，服務管理器(SM)將不允許他進行車載霧服務(fog service)，因此他需要發送一個新的訪問請求，這將需要成本，因此沒有任何好處。
* 交易和完整交易的資料內容都經過雜湊處理(hash)，以保護其不被更改，從而保持完整性。

不可否認性
* 稽核部門可以檢查公共分類賬以獲得任何車輛的真實身份，還可以獲得公共金鑰，因此沒有人可以否認他的不當行為。
* 發送任何訊息後，節點無法拒絕承認，因為訊息附加了數位簽名。該模型還可偵測惡意密鑰(rogue key)攻擊。
* 目前所有的區塊交易均由交易發起者簽署並由驗證者確認，以避免對行動的否認。

隱私
* 車輛可以使用自己定義的假名，事實上，可以在需要時重新驗證自己來更改假名。
* 該方案使用(t,n)閾值秘密共享方案生成每個追踪器的部分追踪標記，因此每個追踪只能生成一個部分追踪標記。需要 n(total) 個標籤中的最少 t(threshold value) 來獲取節點的真實身份。
* 設計一個基於 IEEE 1609.2 的解決方案，在該解決方案中，一個節點可以與其他不透露其原始身份的節點進行通訊。

一致性
* 在父區塊鏈中，部署智慧型合約以便在父區塊鍊和輔助區塊鏈之間保持一致的數據。

### VANET資通攻擊

身份認證攻擊
1. 偽裝 Impersonation：出於惡意，攻擊者使用假身份冒充其他車輛以保護自己不被識別，有時還偽裝成警察以獲得快速移動的自由道路。這也稱為欺騙攻擊(spoofing attack)
1. Sybil：攻擊者向車輛發送來自不同身份的多條訊息強迫改變路徑，從而製造出堵車的假象

隱私攻擊
1. 身份揭示 Identity revealing：這種攻擊中，攻擊者向車主發送惡意程式碼來揭示車主的身份。這些訊息可能會被使用並使隱私處於危險之中。
2. 位置追踪 Location Tracking：觀察者跟踪一些目標車輛的位置。如果惡意用戶為了利益而出於錯誤的意圖執行此跟踪可能是負面的，如果某些汽車租賃組織為了乘客的安全而執行此跟踪有時可能是好的。

機密性攻擊
1. 中間人攻擊 Man-in-the-middle attack：在這種情況下，攻擊者偷偷地傳輸並可能修改兩輛車之間傳輸的數據，他們假設它們正在互動。
2. 重放攻擊 Replay Attack：這是發起者本人或捕獲數據的對手惡意發送重複的數據副本或IP封包替換延遲數據的攻擊。這是一種中間人攻擊。
3. 竊聽 Eavesdropping：這種網路層的被動攻擊，主要目的是存取車輛的機密資料。

完整性攻擊 Integrity Attack
1. 在這種情況下，攻擊者持有一些包含關鍵資訊的傳輸數據封包來破壞訊息的完整性。這種攻擊的一個重要例子是保存道路上的碰撞數據，這樣保險機構就無法在碰撞過程中揭示攻擊者車輛的故障。

可用性攻擊 Availability attacks
1. 拒絕服務(DoS)：這種情況下，惡意用戶在通信媒介上發送無關的大量訊息來阻塞通道，目的是使身份驗證的用戶無法使用網路和網路資源。
2. 分散式 DoS 攻擊 Distributed DoS attack：DDoS 攻擊是指攻擊者利用不同的位置和時間發起攻擊，意圖關閉網路。

連結攻擊 Linking attack
1. 與同一匿名用戶(anonymous user)連接的不同數據可能會被攻擊者去匿名化。這種類型的攻擊稱為連接攻擊(Linking attack)。

### 攻擊與區塊鏈解決方案

* Sybil Resistance
	* 使用 Lagrange 內插法、Threshold cryptographic technique 的方法確保固定數目的私有金曜所產生的簽章。
* Replay Attack
	* 每件訊息都包含時間描述，因此接收訊息的接收者將確認當前時間和事件時間，因此如果有任何差異，可以丟棄訊息。只有當攻擊者修改實際訊息的內容並偽造有效簽名時，這種情況才可能發生，這在此方案中的可能性較小。
	* 方案不易受到重放攻擊，因為接收方會發現當前時間與訊息中附加的時間戳之間的差異，如果差異超過 25 毫秒，則會談將結束。
* Server Spoofing 
	* 每次通訊過程中的相互驗證是方案的關鍵特性。為了防止服務器欺騙攻擊，每件訊息都附有一個時間戳，以計算接收方對請求的反應時間。如果它大於預定義的閾值，則會談[^2]將立即結束。
* Message tampering
	* 每件訊息都附有訊標地址 (TA)，沒有一個用戶知道其他用戶的 TA，因此很難更改另一個用戶的訊息，如果嘗試這樣做，RSU 將識別 TA 和 OBU 標記之間的不匹配並將結束會談。
	* 可以對一個塊進行篡改，直到它達到最大塊容量，這給驗證者達成共識帶來了問題。為了克服它，提出一個驗證交易的系統，因此很難在不檢測的情況下竄改交易。
* Man-in-themiddle
	* 使用橢圓曲線密碼技術可防止這種攻擊。由於私鑰不與任何人共享，因此沒有第三方可以捕獲網路上兩個實體之間的任何通訊。
* Impersonation
	* 該系統中的任何實體都不能被任何其他實體冒充，因為所有實體都使用唯一的訓標地址來計算訊息。
* False information
	* 如果自駕車串通，製造商在收到它時，將嘗試更改內容併計算一個新的雜湊值，但如果計算出的雜奏值與製造商及保險公司提供的資料戳記不同時，將被查獲。
	* 冒充製造商或軟體、更新提供者的方式進行假更新。儘管覆蓋網路中的所有節點都知道製造商和更新提供商的公鑰，但不能聲稱自己是這些實體中的任何一個，因為需要與這些實體的公鑰連結的私鑰。
* Linking attack
	* 提出的防止覆蓋網絡中的連接攻擊的方案中，每個用戶在每次互動時都使用一個新密鑰。
* Distributed Denial of service
	* 交易被廣播到所有覆蓋區塊管理器（OBM），只有當交易中的密鑰與其密鑰列表中的密鑰對匹配時，才會將其轉發給聚群成員。覆蓋節點在 OBM 的密鑰列表中上傳密鑰對來批准請求者訪問它們。 DDoS 攻擊交易可能不會在密鑰列表中生成匹配項，因此會被丟棄，因此不會影響目標節點。


電動車的安全性和隱私性存在很高的風險。需要時間和確定方法來提高電動汽車充電系統的性能，使其易於採用並超越燃油汽車市場。區塊鏈技術為解決電動汽車中的安全能量流動問題提供了一種很有前景的解決方案。

自駕車是一種可以感知周圍環境並且可以在沒有人為干擾的情況下導航的汽車。為此，它由負責感知、定位、規劃和控制的組件組成。感測中使用的各種技術包括激光雷達（光檢測和測距）、雷達、里程計和電腦視覺。它使用各種感測器輸入，分析道路狀況、交通信號誌、路標、車道邊界和相鄰車輛。為了高效工作，自駕車的設計和實施應該能夠實現強韌、精細退化、故障安全特性、硬體/軟體設計和客戶滿意度等目標。自駕車展示的好處是增強安全性、商業機會和增加利潤、更好的交通狀況、自動泊車、以消費者為中心的體驗。除了各種好處外，自動駕駛汽車仍面臨技術、法律和政策挑戰。隨著最新技術和政府推出的適當政策的出現，自駕車作為未來產品在市場上獲得了相當好的地位，但它仍然面臨許多需要製造商、軟體開發商、硬體工程師、研究人員解決的問題，以使完全商業化的產品。自駕車的挑戰

* 工業：product making, analysis of bug data, service management, object detection, safty, reliability, cybersecurity
* 技術：cost, liability, road conditions, traffic conditions, weather conditions, 
* 社會：human behavior, ethetic issues, motal issues
* 政策：regulations, 

車輛事故的情況下，涉及保險的實體包括保險公司、車輛所有者、政府交通部門、警察和法院，但在自駕車的情況，除這些之外，還涉及車輛製造商和軟體工程師和技術人員。目前，保險索賠程序是人為的，雖然在發生欺詐的情況下是必要的，但過程相當繁瑣且成本高昂。因此，對於明確的案例或成本較低的案例，至少可以使該過程自動化，從而節省時間和成本。上述任何實體都可能存在惡意行為，因此需要第三方。區塊鏈的去中心化財產和不可變賬本可以使互不信任的實體之間的程序透明化，並使它們相互信任。基於區塊鏈的方法還可以使用由自駕車生成的感測器數據作為證據，並且不允許為了個人利益而對該數據進行任何更改。這種方法還可以分析任何實體可能承擔的責任，這與普通車輛不同，後者僅由車輛駕駛員承擔

[^1]: 於多站點﹑多國家或多家機構所組成的網絡上進行電子數據複製﹑共享及同步的同識，當中並不存在中央管理員或集中的數據存儲
[^2]: 兩個設備、兩個系統或系統的兩個部分之間通訊的特定時間範圍